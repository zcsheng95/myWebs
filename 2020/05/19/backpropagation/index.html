<!DOCTYPE html>
<html lang="en">
<head>
  <script src="/js/src/photoswipe.min.js?v="></script>
  <script src="/js/src/photoswipe-ui-default.min.js?v="></script>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic|Comic Sans MS:300,300italic,400,400italic,700,700italic|Palatino:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"zcsheng95.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":true,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":"gitalk","storage":false,"lazyload":true,"nav":null,"activeClass":"gitalk"},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="article">
<meta property="og:title" content="About Back Propagation">
<meta property="og:url" content="http://zcsheng95.github.io/2020/05/19/backpropagation/index.html">
<meta property="og:site_name" content="Jeff&#39;s Story">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://zcsheng95.github.io/2020/05/19/backpropagation/Exp1.png">
<meta property="article:published_time" content="2020-05-19T04:13:38.000Z">
<meta property="article:modified_time" content="2020-05-21T02:33:18.836Z">
<meta property="article:author" content="Jeff Sheng">
<meta property="article:tag" content="Data Science">
<meta property="article:tag" content="Deep Learning">
<meta property="article:tag" content="Statistics">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://zcsheng95.github.io/2020/05/19/backpropagation/Exp1.png">

<link rel="canonical" href="http://zcsheng95.github.io/2020/05/19/backpropagation/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>About Back Propagation | Jeff's Story</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>
<body itemscope itemtype="http://schema.org/WebPage">
  
  <div class="container use-motion">
    <div class="headband"></div>
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Jeff's Story</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">LEARN  âœ¨ SHARE</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-cv">

    <a href="/resume/" rel="section"><i class="fa fa-file fa-fw"></i>CV</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-gallery">

    <a href="/photos/" rel="section"><i class="fa fa-camera-retro fa-fw"></i>Gallery</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://zcsheng95.github.io/2020/05/19/backpropagation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/profile.jpeg">
      <meta itemprop="name" content="Jeff Sheng">
      <meta itemprop="description" content="Life is long so take your time">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Jeff's Story">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          About Back Propagation
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2020-05-19 00:13:38" itemprop="dateCreated datePublished" datetime="2020-05-19T00:13:38-04:00">2020-05-19</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-05-20 22:33:18" itemprop="dateModified" datetime="2020-05-20T22:33:18-04:00">2020-05-20</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Algorithm/" itemprop="url" rel="index"><span itemprop="name">Algorithm</span></a>
                </span>
            </span>

          
            <span class="post-meta-item" title="Views" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">Views: </span>
              <span id="busuanzi_value_page_pv"></span>
            </span>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"<p>Back propagation is an algorithm computing all those complicated gradients in deep neural networks in order to achieve minimum of cost function. Instead of thinking each weights/bias as direction in a high dimensional space, one can see the value as how sensitive the cost function is to each weight and bias. One can not directly change the activation but can only adjust the weight and bias. However, we are aware which direction we want this activation value to go. Back propagation basically improves those neurons which positively activates the correct output unit and undermine the activation for other wrong output units. <a id="more"></a></p>
<p>We could manipulate the output unit by nudging <strong>weight</strong>(proportional corresponding activation), <strong>bias</strong>, or <strong>activation</strong>(indirectly, proportional to corresponding weight) from previous layer. <strong>Back Propagation</strong> utilizes the concepts of Chain Rule in Calculus to update weights and biases.</p>
<h4 id="minimum-example">Minimum example</h4>
<p>Let's start from an extreme simple sample where a network with 3 hidden layers and each layer has only one neuron.</p>
<p><a href="Exp1.png" class="gallery-item"><img src="Exp1.png" /></a></p>
<p>The goal is to minimize the cost function <span class="math inline">\(C_0\)</span>, which is defined as <span class="math inline">\((a^{(L)} - y )^2\)</span>, <span class="math inline">\(a^{(L)}\)</span> denotes the <span class="math inline">\(L^{th}\)</span> activation vector.</p>
<p>Sequentially, activation <span class="math inline">\(a^{(L)}\)</span> can be written as the weighted sum plus the bias of the previous layer <span class="math inline">\(a^{(L)} = \sigma(w^{(L)}a^{(L-1)} + b^{(L)}) = \sigma(z^{(L)})\)</span>, <span class="math inline">\(\sigma\)</span> is any activation function like sigmoid or ReLU. By calculating the gradient, we access how sensitive the cost function is to tiny nudges of weight and biases. Step back one layer, we have:</p>
<p><span class="math display">\[\frac{\partial C_0}{\partial w^{L}} = \frac{\partial z^{(L)}}{\partial w^{(L)}}\cdot\frac{\partial a^{(L)}}{\partial z^{(L)}}\cdot\frac{\partial C_0}{\partial a^{(L)}}\]</span></p>
<p><span class="math display">\[\frac{\partial z^{(L)}}{\partial w^{(L)}} = a^{(L-1)}\]</span></p>
<p><span class="math display">\[\frac{\partial a^{(L)}}{\partial z^{(L)}} = \sigma^{&#39;}(z^{(L)})\]</span></p>
<p><span class="math display">\[\frac{\partial C_0}{\partial a^{(L)}} = 2\cdot(a^{(L)}-y)\]</span></p>
<p>Finally we obtain:</p>
<p><span class="math display">\[\frac{\partial C_0}{\partial w^{L}} = 2\cdot a^{(L-1)} \cdot \sigma^{&#39;}(z^{(L)}) \cdot (a^{(L)}-y)\]</span></p>
<p>Similarly we could compute <span class="math inline">\(\frac{\partial C_0}{\partial b^{L}} = \sigma^{&#39;}(z^{(L)}) \cdot 2\cdot(a^{(L)}-y)\)</span> and how sensitive the cost function to the change of activation <span class="math inline">\(\frac{\partial C_0}{\partial a^{(L-1)}} = w^{(L-1)}\cdot \sigma^{&#39;}(z^{(L)}) \cdot 2\cdot(a^{(L)}-y)\)</span></p>
<h4 id="generalization">Generalization</h4>
<p>When we have multiple neurons in each layer, we use <span class="math inline">\(a_k^{(L-1)}\)</span> to index the activation value of layer <span class="math inline">\(L-1\)</span> and <span class="math inline">\(a_j^{(L)}\)</span> to index the activation value of layer <span class="math inline">\(L\)</span> and <span class="math inline">\(y_j\)</span> to index <span class="math inline">\(j^{th}\)</span> class among all labels. So the cost function becomes the average of quadratic difference across all labels, <span class="math inline">\(C_0 = \Sigma_{j=1}^{n_L}(a_j^{(L)} - y_j)^2\)</span>. And we will also need to change the index of the weight vector. For example, <span class="math inline">\(w_{jk}^{(L)}\)</span> is the weight between <span class="math inline">\(a_k^{(L-1)}\)</span> and <span class="math inline">\(a_j^{(L)}\)</span> that is <span class="math inline">\(z_j^{(L)} = w_{j1}^{(L-1)}\cdot a_1^{(L-1)} + w_{j2}^{(L-1)}\cdot a_2^{(L-1)} + ... + w_{jk}\cdot a_k^{(L-1)} + b^{(L)}\)</span> and <span class="math inline">\(a_j^{(L)} = \sigma(z_j^{(L)})\)</span></p>
<p>The chained derivative of <span class="math inline">\(\frac{\partial C_0}{\partial a_k^{(L-1)}}\)</span> will change, as the change of one neuron from previous layer will effect all output units respectively.</p>
<p><span class="math display">\[\frac{\partial C_0}{\partial a_k^{(L-1)}} = 2\cdot\underbrace{\Sigma_{j=1}^{n_L}w_{jk}^{(L-1)}\cdot \sigma^{&#39;}(z_j^{(L)})\cdot (a_j^{(L)}-y)}_\text{Sum Over Layer L}\]</span></p>
<p>Combining the above information, we could write out all the components in the gradient: <span class="math display">\[ \nabla C =\begin{bmatrix} \frac{\partial C_0}{\partial w_{11}^{1}} \\ \frac{\partial C_0}{\partial w_{12}^{1}} \\ \frac{\partial C_0}{\partial w_{13}^{1}} \\ ...\\\frac{\partial C_0}{\partial b^{1}}\\...\\ \frac{\partial C_0}{\partial b^{L}}\end{bmatrix}\]</span></p>
<p>And we could calculate back propagation for those components:</p>
<p><span class="math display">\[ \frac{\partial C_0}{\partial w_{jk}^{l}} = \begin{cases}
a^{(l-1)} \cdot \sigma^{&#39;}(z^{(l)})\underbrace{\frac{\partial C_0}{\partial a^{(l)}}}_{\Sigma_{j=1}^{n_{l+1}}w_{jk}^{(l)}\cdot \sigma^{&#39;}(z_j^{(l+1)})\cdot \frac{\partial C_0}{\partial a_k^{(l+1)}}}, &amp; \text{if l &lt; L}\\
2\cdot a^{(l-1)} \cdot \sigma^{&#39;}(z^{(l)}) \cdot (a^{(l)}-y), &amp; \text{if l = L}
\end{cases}\]</span></p>
<p><span class="math display">\[\frac{\partial C_0}{\partial b^{l}} = \sigma^{&#39;}(z^{(l)}) \cdot \frac{\partial C_0}{\partial a^{(l)}}\]</span></p>
<p><span class="math inline">\(L\)</span> denotes the output layer in the above formula and the cases of <span class="math inline">\(\frac{\partial C_0}{\partial a^{(l)}}\)</span> while calculating the derivative for bias.</p>
<p>As one can observe that the calculation of back propagation is computationally heavy when we have tons of samples, that is the intuition why people bring up down-sampling strategies like <em>Mini-Batch Gradient Descent</em> and <em>Stochastic Gradient Descent</em>.</p>
<p>Reference: <a href="https://www.youtube.com/watch?v=tIeHLnjs5U8" target="_blank" rel="noopener">Backpropagation calculus | Deep learning, chapter 4</a></p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>
    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Data-Science/" rel="tag"># Data Science</a>
              <a href="/tags/Deep-Learning/" rel="tag"># Deep Learning</a>
              <a href="/tags/Statistics/" rel="tag"># Statistics</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2020/04/11/Duke-Intro-to-Machine-Learning-Notes/" rel="prev" title="Duke Intro to Machine Learning Notes">
      <i class="fa fa-chevron-left"></i> Duke Intro to Machine Learning Notes
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-4"><a class="nav-link" href="#minimum-example"><span class="nav-number">1.</span> <span class="nav-text">Minimum example</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#generalization"><span class="nav-number">2.</span> <span class="nav-text">Generalization</span></a></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="Jeff Sheng"
      src="/images/profile.jpeg">
  <p class="site-author-name" itemprop="name">Jeff Sheng</p>
  <div class="site-description" itemprop="description">Life is long so take your time</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">4</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jeff Sheng</span>
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="Total Visitors">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="Total Views">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  
  <script color='255,255,255' opacity='0.5' zIndex='-1' count='99' src="/lib/canvas-nest/canvas-nest.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.3.5/jquery.fancybox.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  
      

<script>
  if (typeof MathJax === 'undefined') {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd',
          '[tex]/AMScd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: {'[+]': [['$', '$']]},
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            document.querySelectorAll('script[type^="math/tex"]').forEach(node => {
              const display = !!node.type.match(/; *mode=display/);
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display);
              const text = document.createTextNode('');
              node.parentNode.replaceChild(text, node);
              math.start = {node: text, delim: '', n: 0};
              math.end = {node: text, delim: '', n: 0};
              doc.math.push(math);
            });
          }, '', false],
          insertedScript: [200, () => {
            document.querySelectorAll('mjx-container').forEach(node => {
              let target = node.parentNode;
              if (target.nodeName.toLowerCase() === 'li') {
                target.parentNode.classList.add('has-jax');
              }
            });
          }, '', false]
        }
      }
    };
    (function () {
      var script = document.createElement('script');
      script.src = '//cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js';
      script.defer = true;
      document.head.appendChild(script);
    })();
  } else {
    MathJax.startup.document.state(0);
    MathJax.texReset();
    MathJax.typeset();
  }
</script>

    

  


</body>
</html>
